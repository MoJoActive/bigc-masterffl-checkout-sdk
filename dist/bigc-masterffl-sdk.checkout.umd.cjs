(function(M,l){typeof exports=="object"&&typeof module<"u"?l(exports,require("react"),require("react-dom")):typeof define=="function"&&define.amd?define(["exports","react","react-dom"],l):(M=typeof globalThis<"u"?globalThis:M||self,l(M.MasterFFLCheckout={},M.React,M.ReactDOM))})(this,function(M,l,Ge){"use strict";var oe={exports:{}},J={};/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var ge;function Xe(){if(ge)return J;ge=1;var a=l,s=Symbol.for("react.element"),u=Symbol.for("react.fragment"),o=Object.prototype.hasOwnProperty,d=a.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,v={key:!0,ref:!0,__self:!0,__source:!0};function C(F,p,b){var m,g={},S=null,T=null;b!==void 0&&(S=""+b),p.key!==void 0&&(S=""+p.key),p.ref!==void 0&&(T=p.ref);for(m in p)o.call(p,m)&&!v.hasOwnProperty(m)&&(g[m]=p[m]);if(F&&F.defaultProps)for(m in p=F.defaultProps,p)g[m]===void 0&&(g[m]=p[m]);return{$$typeof:s,type:F,key:S,ref:T,props:g,_owner:d.current}}return J.Fragment=u,J.jsx=C,J.jsxs=C,J}var K={};/**
 * @license React
 * react-jsx-runtime.development.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var ve;function Ze(){return ve||(ve=1,process.env.NODE_ENV!=="production"&&function(){var a=l,s=Symbol.for("react.element"),u=Symbol.for("react.portal"),o=Symbol.for("react.fragment"),d=Symbol.for("react.strict_mode"),v=Symbol.for("react.profiler"),C=Symbol.for("react.provider"),F=Symbol.for("react.context"),p=Symbol.for("react.forward_ref"),b=Symbol.for("react.suspense"),m=Symbol.for("react.suspense_list"),g=Symbol.for("react.memo"),S=Symbol.for("react.lazy"),T=Symbol.for("react.offscreen"),R=Symbol.iterator,k="@@iterator";function w(e){if(e===null||typeof e!="object")return null;var t=R&&e[R]||e[k];return typeof t=="function"?t:null}var j=a.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED;function E(e){{for(var t=arguments.length,r=new Array(t>1?t-1:0),i=1;i<t;i++)r[i-1]=arguments[i];U("error",e,r)}}function U(e,t,r){{var i=j.ReactDebugCurrentFrame,h=i.getStackAddendum();h!==""&&(t+="%s",r=r.concat([h]));var y=r.map(function(f){return String(f)});y.unshift("Warning: "+t),Function.prototype.apply.call(console[e],console,y)}}var $=!1,ee=!1,te=!1,ie=!1,A=!1,O;O=Symbol.for("react.module.reference");function G(e){return!!(typeof e=="string"||typeof e=="function"||e===o||e===v||A||e===d||e===b||e===m||ie||e===T||$||ee||te||typeof e=="object"&&e!==null&&(e.$$typeof===S||e.$$typeof===g||e.$$typeof===C||e.$$typeof===F||e.$$typeof===p||e.$$typeof===O||e.getModuleId!==void 0))}function X(e,t,r){var i=e.displayName;if(i)return i;var h=t.displayName||t.name||"";return h!==""?r+"("+h+")":r}function xe(e){return e.displayName||"Context"}function N(e){if(e==null)return null;if(typeof e.tag=="number"&&E("Received an unexpected object in getComponentNameFromType(). This is likely a bug in React. Please file an issue."),typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e;switch(e){case o:return"Fragment";case u:return"Portal";case v:return"Profiler";case d:return"StrictMode";case b:return"Suspense";case m:return"SuspenseList"}if(typeof e=="object")switch(e.$$typeof){case F:var t=e;return xe(t)+".Consumer";case C:var r=e;return xe(r._context)+".Provider";case p:return X(e,e.render,"ForwardRef");case g:var i=e.displayName||null;return i!==null?i:N(e.type)||"Memo";case S:{var h=e,y=h._payload,f=h._init;try{return N(f(y))}catch{return null}}}return null}var W=Object.assign,Z=0,_e,Ee,Te,Re,je,Ie,Le;function Oe(){}Oe.__reactDisabledLog=!0;function lt(){{if(Z===0){_e=console.log,Ee=console.info,Te=console.warn,Re=console.error,je=console.group,Ie=console.groupCollapsed,Le=console.groupEnd;var e={configurable:!0,enumerable:!0,value:Oe,writable:!0};Object.defineProperties(console,{info:e,log:e,warn:e,error:e,group:e,groupCollapsed:e,groupEnd:e})}Z++}}function ct(){{if(Z--,Z===0){var e={configurable:!0,enumerable:!0,writable:!0};Object.defineProperties(console,{log:W({},e,{value:_e}),info:W({},e,{value:Ee}),warn:W({},e,{value:Te}),error:W({},e,{value:Re}),group:W({},e,{value:je}),groupCollapsed:W({},e,{value:Ie}),groupEnd:W({},e,{value:Le})})}Z<0&&E("disabledDepth fell below zero. This is a bug in React. Please file an issue.")}}var le=j.ReactCurrentDispatcher,ce;function re(e,t,r){{if(ce===void 0)try{throw Error()}catch(h){var i=h.stack.trim().match(/\n( *(at )?)/);ce=i&&i[1]||""}return`
`+ce+e}}var ue=!1,ae;{var ut=typeof WeakMap=="function"?WeakMap:Map;ae=new ut}function ke(e,t){if(!e||ue)return"";{var r=ae.get(e);if(r!==void 0)return r}var i;ue=!0;var h=Error.prepareStackTrace;Error.prepareStackTrace=void 0;var y;y=le.current,le.current=null,lt();try{if(t){var f=function(){throw Error()};if(Object.defineProperty(f.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(f,[])}catch(L){i=L}Reflect.construct(e,[],f)}else{try{f.call()}catch(L){i=L}e.call(f.prototype)}}else{try{throw Error()}catch(L){i=L}e()}}catch(L){if(L&&i&&typeof L.stack=="string"){for(var c=L.stack.split(`
`),I=i.stack.split(`
`),x=c.length-1,_=I.length-1;x>=1&&_>=0&&c[x]!==I[_];)_--;for(;x>=1&&_>=0;x--,_--)if(c[x]!==I[_]){if(x!==1||_!==1)do if(x--,_--,_<0||c[x]!==I[_]){var P=`
`+c[x].replace(" at new "," at ");return e.displayName&&P.includes("<anonymous>")&&(P=P.replace("<anonymous>",e.displayName)),typeof e=="function"&&ae.set(e,P),P}while(x>=1&&_>=0);break}}}finally{ue=!1,le.current=y,ct(),Error.prepareStackTrace=h}var B=e?e.displayName||e.name:"",Y=B?re(B):"";return typeof e=="function"&&ae.set(e,Y),Y}function ft(e,t,r){return ke(e,!1)}function dt(e){var t=e.prototype;return!!(t&&t.isReactComponent)}function ne(e,t,r){if(e==null)return"";if(typeof e=="function")return ke(e,dt(e));if(typeof e=="string")return re(e);switch(e){case b:return re("Suspense");case m:return re("SuspenseList")}if(typeof e=="object")switch(e.$$typeof){case p:return ft(e.render);case g:return ne(e.type,t,r);case S:{var i=e,h=i._payload,y=i._init;try{return ne(y(h),t,r)}catch{}}}return""}var Q=Object.prototype.hasOwnProperty,Pe={},De=j.ReactDebugCurrentFrame;function se(e){if(e){var t=e._owner,r=ne(e.type,e._source,t?t.type:null);De.setExtraStackFrame(r)}else De.setExtraStackFrame(null)}function pt(e,t,r,i,h){{var y=Function.call.bind(Q);for(var f in e)if(y(e,f)){var c=void 0;try{if(typeof e[f]!="function"){var I=Error((i||"React class")+": "+r+" type `"+f+"` is invalid; it must be a function, usually from the `prop-types` package, but received `"+typeof e[f]+"`.This often happens because of typos such as `PropTypes.function` instead of `PropTypes.func`.");throw I.name="Invariant Violation",I}c=e[f](t,f,i,r,null,"SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED")}catch(x){c=x}c&&!(c instanceof Error)&&(se(h),E("%s: type specification of %s `%s` is invalid; the type checker function must return `null` or an `Error` but returned a %s. You may have forgotten to pass an argument to the type checker creator (arrayOf, instanceOf, objectOf, oneOf, oneOfType, and shape all require an argument).",i||"React class",r,f,typeof c),se(null)),c instanceof Error&&!(c.message in Pe)&&(Pe[c.message]=!0,se(h),E("Failed %s type: %s",r,c.message),se(null))}}}var mt=Array.isArray;function fe(e){return mt(e)}function ht(e){{var t=typeof Symbol=="function"&&Symbol.toStringTag,r=t&&e[Symbol.toStringTag]||e.constructor.name||"Object";return r}}function gt(e){try{return Ae(e),!1}catch{return!0}}function Ae(e){return""+e}function Me(e){if(gt(e))return E("The provided key is an unsupported type %s. This value must be coerced to a string before before using it here.",ht(e)),Ae(e)}var Ne=j.ReactCurrentOwner,vt={key:!0,ref:!0,__self:!0,__source:!0},Ue,We;function yt(e){if(Q.call(e,"ref")){var t=Object.getOwnPropertyDescriptor(e,"ref").get;if(t&&t.isReactWarning)return!1}return e.ref!==void 0}function bt(e){if(Q.call(e,"key")){var t=Object.getOwnPropertyDescriptor(e,"key").get;if(t&&t.isReactWarning)return!1}return e.key!==void 0}function Ct(e,t){typeof e.ref=="string"&&Ne.current}function wt(e,t){{var r=function(){Ue||(Ue=!0,E("%s: `key` is not a prop. Trying to access it will result in `undefined` being returned. If you need to access the same value within the child component, you should pass it as a different prop. (https://reactjs.org/link/special-props)",t))};r.isReactWarning=!0,Object.defineProperty(e,"key",{get:r,configurable:!0})}}function Ft(e,t){{var r=function(){We||(We=!0,E("%s: `ref` is not a prop. Trying to access it will result in `undefined` being returned. If you need to access the same value within the child component, you should pass it as a different prop. (https://reactjs.org/link/special-props)",t))};r.isReactWarning=!0,Object.defineProperty(e,"ref",{get:r,configurable:!0})}}var St=function(e,t,r,i,h,y,f){var c={$$typeof:s,type:e,key:t,ref:r,props:f,_owner:y};return c._store={},Object.defineProperty(c._store,"validated",{configurable:!1,enumerable:!1,writable:!0,value:!1}),Object.defineProperty(c,"_self",{configurable:!1,enumerable:!1,writable:!1,value:i}),Object.defineProperty(c,"_source",{configurable:!1,enumerable:!1,writable:!1,value:h}),Object.freeze&&(Object.freeze(c.props),Object.freeze(c)),c};function xt(e,t,r,i,h){{var y,f={},c=null,I=null;r!==void 0&&(Me(r),c=""+r),bt(t)&&(Me(t.key),c=""+t.key),yt(t)&&(I=t.ref,Ct(t,h));for(y in t)Q.call(t,y)&&!vt.hasOwnProperty(y)&&(f[y]=t[y]);if(e&&e.defaultProps){var x=e.defaultProps;for(y in x)f[y]===void 0&&(f[y]=x[y])}if(c||I){var _=typeof e=="function"?e.displayName||e.name||"Unknown":e;c&&wt(f,_),I&&Ft(f,_)}return St(e,c,I,h,i,Ne.current,f)}}var de=j.ReactCurrentOwner,Ye=j.ReactDebugCurrentFrame;function z(e){if(e){var t=e._owner,r=ne(e.type,e._source,t?t.type:null);Ye.setExtraStackFrame(r)}else Ye.setExtraStackFrame(null)}var pe;pe=!1;function me(e){return typeof e=="object"&&e!==null&&e.$$typeof===s}function Ve(){{if(de.current){var e=N(de.current.type);if(e)return`

Check the render method of \``+e+"`."}return""}}function _t(e){return""}var ze={};function Et(e){{var t=Ve();if(!t){var r=typeof e=="string"?e:e.displayName||e.name;r&&(t=`

Check the top-level render call using <`+r+">.")}return t}}function Be(e,t){{if(!e._store||e._store.validated||e.key!=null)return;e._store.validated=!0;var r=Et(t);if(ze[r])return;ze[r]=!0;var i="";e&&e._owner&&e._owner!==de.current&&(i=" It was passed a child from "+N(e._owner.type)+"."),z(e),E('Each child in a list should have a unique "key" prop.%s%s See https://reactjs.org/link/warning-keys for more information.',r,i),z(null)}}function Je(e,t){{if(typeof e!="object")return;if(fe(e))for(var r=0;r<e.length;r++){var i=e[r];me(i)&&Be(i,t)}else if(me(e))e._store&&(e._store.validated=!0);else if(e){var h=w(e);if(typeof h=="function"&&h!==e.entries)for(var y=h.call(e),f;!(f=y.next()).done;)me(f.value)&&Be(f.value,t)}}}function Tt(e){{var t=e.type;if(t==null||typeof t=="string")return;var r;if(typeof t=="function")r=t.propTypes;else if(typeof t=="object"&&(t.$$typeof===p||t.$$typeof===g))r=t.propTypes;else return;if(r){var i=N(t);pt(r,e.props,"prop",i,e)}else if(t.PropTypes!==void 0&&!pe){pe=!0;var h=N(t);E("Component %s declared `PropTypes` instead of `propTypes`. Did you misspell the property assignment?",h||"Unknown")}typeof t.getDefaultProps=="function"&&!t.getDefaultProps.isReactClassApproved&&E("getDefaultProps is only used on classic React.createClass definitions. Use a static property named `defaultProps` instead.")}}function Rt(e){{for(var t=Object.keys(e.props),r=0;r<t.length;r++){var i=t[r];if(i!=="children"&&i!=="key"){z(e),E("Invalid prop `%s` supplied to `React.Fragment`. React.Fragment can only have `key` and `children` props.",i),z(null);break}}e.ref!==null&&(z(e),E("Invalid attribute `ref` supplied to `React.Fragment`."),z(null))}}var Ke={};function He(e,t,r,i,h,y){{var f=G(e);if(!f){var c="";(e===void 0||typeof e=="object"&&e!==null&&Object.keys(e).length===0)&&(c+=" You likely forgot to export your component from the file it's defined in, or you might have mixed up default and named imports.");var I=_t();I?c+=I:c+=Ve();var x;e===null?x="null":fe(e)?x="array":e!==void 0&&e.$$typeof===s?(x="<"+(N(e.type)||"Unknown")+" />",c=" Did you accidentally export a JSX literal instead of a component?"):x=typeof e,E("React.jsx: type is invalid -- expected a string (for built-in components) or a class/function (for composite components) but got: %s.%s",x,c)}var _=xt(e,t,r,h,y);if(_==null)return _;if(f){var P=t.children;if(P!==void 0)if(i)if(fe(P)){for(var B=0;B<P.length;B++)Je(P[B],e);Object.freeze&&Object.freeze(P)}else E("React.jsx: Static children should always be an array. You are likely explicitly calling React.jsxs or React.jsxDEV. Use the Babel transform instead.");else Je(P,e)}if(Q.call(t,"key")){var Y=N(e),L=Object.keys(t).filter(function(Pt){return Pt!=="key"}),he=L.length>0?"{key: someKey, "+L.join(": ..., ")+": ...}":"{key: someKey}";if(!Ke[Y+he]){var kt=L.length>0?"{"+L.join(": ..., ")+": ...}":"{}";E(`A props object containing a "key" prop is being spread into JSX:
  let props = %s;
  <%s {...props} />
React keys must be passed directly to JSX without using spread:
  let props = %s;
  <%s key={someKey} {...props} />`,he,Y,kt,Y),Ke[Y+he]=!0}}return e===o?Rt(_):Tt(_),_}}function jt(e,t,r){return He(e,t,r,!0)}function It(e,t,r){return He(e,t,r,!1)}var Lt=It,Ot=jt;K.Fragment=o,K.jsx=Lt,K.jsxs=Ot}()),K}process.env.NODE_ENV==="production"?oe.exports=Xe():oe.exports=Ze();var n=oe.exports;const Qe={qa:"https://fflselect-qa.masterffl.com",production:"https://fflselect.masterffl.com"},qe={qa:"https://api-qa.masterffl.com/ffl/bigcommerce/app",production:"https://ffl-api.masterffl.com/ffl/bigcommerce/app"},$e={qa:"https://libs.masterffl.com/ffl-select/select-sdk/9.0.0/ffl-select-sdk.js",production:"https://libs.masterffl.com/ffl-select/select-sdk/9.0.0/ffl-select-sdk.js"},V={heading:"Select an FFL Dealer",subheading:"Your purchase requires the choice of an FFL Dealer where you will pickup the items. Please enter your postal code to find a Dealer near you.",postalCodeLabel:"Postal Code",buttonText:"Choose Dealer",termsLabel:"I understand that this item will be shipped to the FFL dealer I have selected above. I agree that it is my sole responsibility to coordinate with the FFL dealer for the fulfillment of this item.",selectedDealerLabel:"Selected Dealer"},et=async()=>{const[a,s]=await Promise.all([ye(),be()]);let u=!1,o=!1;const d=a?.ffl_custom_attribute_name.trim().toLowerCase(),v=a?.ffl_custom_attribute_value.trim().toLowerCase(),C=a?.ffl_firearm_custom_attribute_name.trim().toLowerCase(),F=a?.ffl_firearm_custom_attribute_value,p=s?.lineItems.physicalItems.map(m=>m.productEntityId),b=await H.getProducts(p);if(u=b.some(m=>m.customFields.some(g=>g.name.trim().toLowerCase()===d&&g.value.trim().toLowerCase()===v)),o=b.some(m=>m.customFields.some(g=>g.name.trim().toLowerCase()===C&&g.value.trim().toLowerCase()===F?.[3]?.toLowerCase())),u||o)return{isFFL:u,isSuppressor:o};if(a&&a?.category_mapping.length>0){const m=b.map(g=>{let S=null;const T=a.category_mapping.filter(R=>g.categoryIds.some(k=>R.categoryId===k.entityId));if(T.length>0){const R=T.reduce((k,w)=>parseInt(w.priority,10)<parseInt(k.priority,10)?w:k);S=R.fflMapping?R:null}return{...g,fflFirearmType:S?S.fflMapping:null}});u=m.some(g=>g.fflFirearmType),o=m.some(g=>g.fflFirearmType&&g.fflFirearmType.trim().toLowerCase()===F?.[3])}return{isFFL:u,isSuppressor:o}},D=()=>({...window.masterFFLConfig||{},env:window.masterFFLConfig?.env||"production",baseUrl:Qe[window.masterFFLConfig?.env||"production"],appUrl:qe[window.masterFFLConfig?.env||"production"],sdkUrl:$e[window.masterFFLConfig?.env||"production"],storeDomain:window.location.hostname.replace("www.",""),storefrontApiToken:window.masterFFLConfig?.storefrontApiToken||window.storefrontAPIToken,lang:{heading:window.masterFFLConfig?.lang?.heading||V.heading,subheading:window.masterFFLConfig?.lang?.subheading||V.subheading,postalCodeLabel:window.masterFFLConfig?.lang?.postalCodeLabel||V.postalCodeLabel,buttonText:window.masterFFLConfig?.lang?.buttonText||V.buttonText,termsLabel:window.masterFFLConfig?.lang?.termsLabel||V.termsLabel,selectedDealerLabel:window.masterFFLConfig?.lang?.selectedDealerLabel||V.selectedDealerLabel}}),ye=async()=>{const a=`mapping-${D().storefrontApiToken}`;window.masterFFLCache=window.masterFFLCache||{};const s=window.masterFFLCache[a];if(s)return s;const d=await(await fetch(`${D().appUrl}/api/internal/mappingdata`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({storeHash:D().storeHash??""})})).json();return window.masterFFLCache[a]=d,d},tt=async(a,s,u=!1)=>{we(a,"selectedDealer");const d=(await be())?.lineItems.physicalItems.map(p=>({itemId:p.entityId,quantity:p.quantity})),v={address:{firstName:s.name,lastName:"n/a",phone:s.contact.primaryPhone?s.contact.primaryPhone:"0000000000",company:s.name,address1:s.contact.address.street1,address2:"",city:s.contact.address.city,stateOrProvinceCode:s.contact.address.state,stateOrProvince:"",shouldSaveAddress:!1,postalCode:s.contact.address.zip,localizedCountry:"United States",countryCode:"US",customFields:[]},lineItems:d};if((await(await fetch(`${D().appUrl}/api/internal/dealer`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({dealerId:s.id.match(/\d+/g)?.join("")||"",cartId:a??"",storeHash:D().storeHash??""})})).json()).status===!1)throw new Error("An error occurred while saving the dealer. Please try again.");return u&&await fetch(`/api/storefront/checkouts/${D().checkoutId}/consignments?include=consignments.availableShippingOptions%2Ccart.lineItems.physicalItems.options%2Ccart.lineItems.digitalItems.options%2Ccustomer%2Cpromotions.banners`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify([{address:v.address,lineItems:v.lineItems}])}),Ce(a,{selectedDealer:JSON.stringify(s)}),{dealer:s,shippingData:v}},be=async()=>{const a=`cart-${D().storefrontApiToken}`;window.masterFFLCache=window.masterFFLCache||{};const s=window.masterFFLCache[a];if(s)return s;const o=await(await fetch("/graphql",{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${D().storefrontApiToken}`},body:JSON.stringify({query:`
        query Cart {
        site {
          cart {
            entityId
            lineItems {
              physicalItems {
                entityId
                productEntityId
                quantity
              }
            }
          }
        }
        }
      `})})).json();return window.masterFFLCache[a]=o.data.site.cart,o.data.site.cart},rt=async a=>a?(await(await fetch("/graphql",{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${D().storefrontApiToken}`},body:JSON.stringify({query:`
            query Products($ids: [Int!]) {
                site {
                    products(entityIds: $ids) {
                        edges {
                            node {
                                entityId
                                categories{
                                  edges{
                                    node{
                                      entityId
                                      name
                                    }
                                  }
                                }
                                customFields {
                                    edges {
                                        node {
                                            name
                                            value
                                        }
                                    }
                                }
                            }
                        }
                    }
                }
            }
        `,variables:{ids:a}})})).json()).data.site.products.edges.map(d=>({entityId:d.node.entityId,customFields:d.node.customFields.edges.map(v=>v.node),categoryIds:d.node.categories.edges.map(v=>v.node)})):[],at=a=>({postalCode:sessionStorage.getItem(`${a}-postalCode`),acceptTerms:sessionStorage.getItem(`${a}-acceptTerms`)==="true"?!0:sessionStorage.getItem(`${a}-acceptTerms`)==="false"?!1:void 0,selectedDealer:sessionStorage.getItem(`${a}-selectedDealer`)}),Ce=(a,s)=>{const{postalCode:u,acceptTerms:o,selectedDealer:d}=s;sessionStorage.setItem(`${a}-postalCode`,u||sessionStorage.getItem(`${a}-postalCode`)||""),sessionStorage.setItem(`${a}-acceptTerms`,o||sessionStorage.getItem(`${a}-acceptTerms`)||""),sessionStorage.setItem(`${a}-selectedDealer`,d||sessionStorage.getItem(`${a}-selectedDealer`)||"")},we=(a,s)=>{sessionStorage.removeItem(`${a}-${s}`)},H={init:et,getConfig:D,getSession:at,setSession:Ce,removeSession:we,saveDealer:tt,getMappingData:ye,getProducts:rt};var Fe=(a=>(a.Billing="billing",a.Customer="customer",a.Payment="payment",a.Shipping="shipping",a))(Fe||{});const Se=l.createContext({}),q=()=>{const a=l.useContext(Se);if(!a)throw new Error("useMasterFFL must be used within a MasterFFLProvider");return a},nt=({checkoutContext:a,getCheckoutStepStatuses:s})=>{const{checkoutService:u,checkoutState:o}=l.useContext(a),d=l.useMemo(()=>o.data.getConfig()?.storeProfile,[o]),v=l.useMemo(()=>o.data.getCheckout()?.id,[o]),C=l.useMemo(()=>d?.storeHash,[d]),[F,p]=l.useState(!1),[b,m]=l.useState({postalCode:"",acceptTerms:!1}),[g,S]=l.useState(null),[T,R]=l.useState(null),[k,w]=l.useState(!1),[j,E]=l.useState(!1);l.useEffect(()=>{if(!v)return;const{postalCode:A,acceptTerms:O,selectedDealer:G}=H.getSession(v);A&&m(X=>({...X,postalCode:A})),O&&m(X=>({...X,acceptTerms:O})),G&&G!=="null"&&R(JSON.parse(G))},[v]);const U=l.useMemo(()=>({...H.getConfig(),storeHash:C,checkoutId:o.data.getCheckout()?.id}),[C,o]),$=l.useCallback(async A=>{R(null),S(null);try{await H.saveDealer(v,A,!0),await u.loadCheckout(v),R(A)}catch{S("An error occurred while saving the dealer. Please try again.")}},[o,U,v,R,S,u]),ee=l.useMemo(()=>s(o),[o]);l.useEffect(()=>{if(ee.find(O=>O.isActive)?.type!==Fe.Shipping&&(!T||!b.acceptTerms)){const O=document.querySelector('.checkout-step--shipping [data-test="step-edit-button"]');O&&O.click()}},[ee,T,b.acceptTerms]);const te=l.useCallback(async()=>{if(!U.storeHash||!o.data.getCart())return;const{isFFL:A,isSuppressor:O}=await H.init();w(A),E(O)},[U.storeHash,o.data.getCart()]);l.useEffect(()=>{te()},[te]);const ie=l.useMemo(()=>({checkoutService:u,checkoutState:o,config:U,isModalOpen:F,setIsModalOpen:p,values:b,setValues:m,handleSaveDealer:$,selectedDealer:T,error:g,isFFL:k,isSuppressor:j}),[u,o,U,F,p,b,m,$,T,g,k,j]);return n.jsx(Se.Provider,{value:ie,children:(k||j)&&n.jsxs(n.Fragment,{children:[n.jsx(st,{}),n.jsx(ot,{}),n.jsx(it,{})]})})},st=()=>{const{setIsModalOpen:a,values:s,setValues:u,selectedDealer:o,config:d,error:v}=q(),[C,F]=l.useState({postalCode:"",acceptTerms:""}),p=l.useRef(null),b=l.useRef(null),m=l.useRef(!1),g=l.useRef(!1);l.useEffect(()=>{m.current=s.acceptTerms},[s.acceptTerms]),l.useEffect(()=>{g.current=!!o},[o]);const S=l.useCallback(()=>{const w=document.getElementById("checkout-shipping-continue");if(!w)return;b.current=w;const j=!m.current||!g.current;w.disabled!==j&&(w.disabled=j)},[]);l.useEffect(()=>{const w=document.getElementById("checkout-shipping-continue")?.parentElement;if(!w)return;const j=()=>S();return p.current=new MutationObserver(j),p.current.observe(w,{childList:!0,subtree:!0,attributes:!0,attributeFilter:["disabled","class"]}),S(),()=>{p.current&&(p.current.disconnect(),p.current=null)}},[S]),l.useEffect(()=>{S()},[S,s.acceptTerms,o]);const T=w=>{F({postalCode:"",acceptTerms:""}),w.target.name==="postalCode"?(u({...s,postalCode:w.target.value}),sessionStorage.setItem(`${d.checkoutId}-postalCode`,w.target.value)):(u({...s,acceptTerms:w.target.checked}),sessionStorage.setItem(`${d.checkoutId}-acceptTerms`,w.target.checked.toString()))},R=()=>{if(F({postalCode:"",acceptTerms:""}),!s.postalCode){F({...C,postalCode:`${d.lang.postalCodeLabel} is required`});return}a(!0)},k=w=>{w.key==="Enter"&&R()};return n.jsxs("div",{className:"form-body",style:{border:"1px solid #ebebeb",padding:"1.5rem",marginBottom:"15px",borderRadius:"4px"},children:[n.jsx("div",{style:{display:"flex",flexDirection:"row",alignItems:"flex-end",justifyContent:"space-between",gap:"15px"},children:n.jsxs("div",{className:`form-field ${C.postalCode?"form-field--error":""}`,style:{flex:1,marginBottom:0},children:[n.jsx("h3",{style:{fontSize:18,margin:"0 0 15px 0"},children:d.lang.heading}),n.jsx("p",{style:{fontWeight:600},children:d.lang.subheading}),n.jsxs("label",{className:"form-label optimizedCheckout-form-label",htmlFor:"postalCode",children:[d.lang.postalCodeLabel," ",n.jsx("span",{style:{color:"red"},children:"*"})]}),n.jsxs("div",{style:{display:"flex",flexDirection:"row",alignItems:"center",gap:10},children:[n.jsx("input",{className:"form-input optimizedCheckout-form-input",id:"postalCode",name:"postalCode",onChange:T,onKeyDown:k,placeholder:"",type:"text",value:s.postalCode}),n.jsx("div",{style:{flexShrink:0},children:n.jsx("button",{onClick:R,style:{margin:0},className:"button button--primary optimizedCheckout-buttonPrimary",children:d.lang.buttonText})})]}),C.postalCode&&n.jsx("ul",{className:"form-field-errors",children:n.jsx("li",{className:"form-field-error",children:n.jsx("label",{"aria-live":"polite",className:"form-inlineMessage",htmlFor:"postalCode",role:"alert",children:C.postalCode})})})]})}),n.jsxs("div",{className:`form-field-agreement form-field ${C.acceptTerms?"form-field--error":""}`,style:{marginTop:15},children:[n.jsx("input",{checked:s.acceptTerms,className:"form-checkbox optimizedCheckout-form-checkbox",id:"accept-agreement",name:"acceptTerms",onChange:T,type:"checkbox"}),n.jsx("label",{className:"form-label optimizedCheckout-form-label",htmlFor:"accept-agreement",children:d.lang.termsLabel}),C.acceptTerms&&n.jsx("ul",{className:"form-field-errors",children:n.jsx("li",{className:"form-field-error",children:n.jsx("label",{"aria-live":"polite",className:"form-inlineMessage",htmlFor:"acceptTerms",role:"alert",children:C.acceptTerms})})})]}),v&&n.jsx("div",{className:"form-field form-field--error",children:n.jsx("ul",{className:"form-field-errors",children:n.jsx("li",{className:"form-field-error",children:n.jsx("label",{"aria-live":"polite",className:"form-inlineMessage",htmlFor:"error",role:"alert",children:v})})})}),o&&n.jsxs("div",{style:{marginTop:15},children:[n.jsxs("div",{className:"form-body",children:[n.jsx("strong",{children:d.lang.selectedDealerLabel}),n.jsx("div",{className:"text-pretty",children:o?.name}),n.jsxs("div",{className:"text-pretty",children:[n.jsxs("span",{className:"block",children:[o?.contact.address.street1," "]}),n.jsxs("span",{children:[o?.contact.address.city,", ",n.jsx("span",{children:o?.contact.address.state})]}),n.jsxs("span",{children:[" ",o?.contact.address.zip]})]})]}),n.jsx("style",{dangerouslySetInnerHTML:{__html:`
                #checkoutShippingAddress, #sameAsBilling, #sameAsBilling + label { display: none; }
                `}})]})]})},ot=()=>{const{config:a}=q();return l.useEffect(()=>{if(document.querySelector(`script[src^="${a.sdkUrl}"]`))return;const u=document.createElement("script");u.src=a.sdkUrl,document.body.appendChild(u)},[a.sdkUrl]),null},it=()=>{const{isModalOpen:a,setIsModalOpen:s,config:u,values:o,handleSaveDealer:d,isSuppressor:v}=q(),C="ffSelectFrame",F=l.useCallback(async b=>{b&&(await d(b),s(!1))},[d,s]);if(l.useEffect(()=>{a&&setTimeout(()=>{new window.FFLSelectSDK.FFLDealerSelector(o.postalCode,C,{url:u.baseUrl},{storeDomain:u.storeDomain,envMode:u.env,filters:v?"exclude_non_sot_dealer=true":"",dealerSelectionCallback:F}).show()},200)},[a,o.postalCode,u.baseUrl,u.storeDomain,u.env,F,v]),!a)return null;const p=n.jsxs(n.Fragment,{children:[n.jsx("style",{dangerouslySetInnerHTML:{__html:".ffl-modal-body { height: 100%; overflow: auto !important; padding: 0 !important; }"}}),n.jsx("div",{style:{position:"fixed",top:0,left:0,right:0,bottom:0,backgroundColor:"rgba(0, 0, 0, 0.5)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:1e3},onClick:()=>s(!1),children:n.jsxs("div",{style:{maxWidth:"95%",width:"100%",height:"80dvh",backgroundColor:"white",display:"flex",flexDirection:"column",position:"relative"},onClick:b=>b.stopPropagation(),children:[n.jsx("button",{onClick:()=>s(!1),style:{position:"absolute",top:"10px",right:"10px",background:"none",border:"none",fontSize:"24px",cursor:"pointer",zIndex:1001},children:"×"}),n.jsx("div",{id:C,className:"ffl-modal-body",style:{height:"100%",flex:1}})]})})]});return Ge.createPortal(p,document.body)};M.MasterFFL=nt,M.useMasterFFL=q,Object.defineProperty(M,Symbol.toStringTag,{value:"Module"})});
//# sourceMappingURL=bigc-masterffl-sdk.checkout.umd.cjs.map
